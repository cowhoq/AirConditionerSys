(function(){"use strict";var t={9664:function(t,e,r){var o=r(6848),a=r(3518),s=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"app"}},[e("header",[e("h1",[t._v("分布式温控系统")]),e("router-view")],1)])},n=[],i={name:"App"},u=i,c=r(1656),l=(0,c.A)(u,s,n,!1,null,null,null),m=l.exports,d=r(6178),p=function(){var t=this,e=t._self._c;return e("div",{staticClass:"login-container"},[e("h1",[t._v("登录")]),e("form",{on:{submit:function(e){return e.preventDefault(),t.login.apply(null,arguments)}}},[e("div",{staticClass:"form-group"},[e("label",{attrs:{for:"roomNumber"}},[t._v("房间号:")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.roomNumber,expression:"roomNumber"}],attrs:{type:"text",id:"roomNumber",required:""},domProps:{value:t.roomNumber},on:{input:function(e){e.target.composing||(t.roomNumber=e.target.value)}}})]),e("div",{staticClass:"form-group"},[e("label",{attrs:{for:"idNumber"}},[t._v("身份证号:")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.idNumber,expression:"idNumber"}],attrs:{type:"text",id:"idNumber",required:""},domProps:{value:t.idNumber},on:{input:function(e){e.target.composing||(t.idNumber=e.target.value)}}})]),e("button",{attrs:{type:"submit"}},[t._v("登录")])])])},h=[],g=(r(4114),r(8355));g.A.defaults.headers["Content-Type"]="application/json;charset=utf-8";const T=g.A.create({baseURL:"http://localhost:8081",timeout:6e4});T.interceptors.request.use((t=>{if("get"===t.method&&t.params){let e=t.url+"?";for(let r of Object.keys(t.params)){let o=t.params[r],a=encodeURIComponent(r)+"=";if(null!==o&&"undefined"!==typeof o)if("object"===typeof o)for(let t of Object.keys(o)){let a=r+"["+t+"]",s=encodeURIComponent(a)+"=";e+=s+encodeURIComponent(o[t])+"&"}else e+=a+encodeURIComponent(o)+"&"}e=e.slice(0,-1),t.params={},t.url=e}return t}),(t=>{console.log(t)})),T.interceptors.response.use((t=>{if(0!==t.data.code||"NOTLOGIN"!==t.data.msg)return t;localStorage.removeItem("userInfo"),localStorage.removeItem("activePage"),window.location.href="/login"}),(t=>{console.log("err: "+t);let{message:e}=t;return"Network Error"==e?e="后端接口连接异常":e.includes("timeout")?e="系统接口请求超时":e.includes("Request failed with status code")&&(e="系统接口 ("+e.substring(e.length-3)+") 异常"),Promise.reject(t)}));var f=T,v={data(){return{roomNumber:"",idNumber:""}},methods:{async login(){console.log(this.roomNumber,this.idNumber);try{let t=await f({url:"/login",method:"post",params:{roomId:this.roomNumber,name:this.idNumber,password:"123456"}});console.log("Response status:",t),1==t.data.code?(console.log("Login successful:",t.data),this.$store.commit("SET_ROOM_NUMBER",this.roomNumber),this.$router.push("/control-panel")):(console.log("Login failed:",t.data),alert(t.data.message||"登录失败，请检查输入或稍后重试。"))}catch(t){console.error("出错了: "+t.message)}}}},_=v,S=(0,c.A)(_,p,h,!1,null,"33c8f7bf",null),b=S.exports,E=function(){var t=this,e=t._self._c;return e("div",{staticClass:"control-panel"},[e("h1",[t._v("控制面板")]),e("main",[e("div",{staticClass:"room-info"},[e("label",{staticClass:"room-label",attrs:{for:"room-id"}},[t._v("房间号：")]),e("span",{staticClass:"room-number"},[t._v(t._s(t.roomNumber))])]),e("div",{staticClass:"cost-info"},[e("label",{staticClass:"room-label",attrs:{for:"room-id"}},[t._v("当前费用: ")]),e("span",{staticClass:"room-number"},[t._v(t._s(t.fee)+"¥")])]),e("div",{staticClass:"energy-info"},[e("label",{staticClass:"room-label",attrs:{for:"room-id"}},[t._v("能耗：")]),e("span",{staticClass:"room-number"},[t._v(t._s(t.energy)+"KW/h")])]),e("button",{class:{active:t.state},on:{click:t.toggleAirConditioning}},[t._v(" "+t._s(t.state?"关闭空调":"开启空调")+" ")]),t.state?e("div",{staticClass:"controls"},[e("div",{staticClass:"left-panel"},[e("TemperatureDisplay")],1),e("div",{staticClass:"right-panel"},[e("TemperatureControl")],1)]):e("div",[e("button",{staticClass:"logout-button",on:{click:t.logout}},[t._v("退出")])])])])},y=[],C=function(){var t=this,e=t._self._c;return e("div",[null===t.currentTemperature?e("h3",[t._v("加载中...")]):e("h3",{staticClass:"temperature"},[t._v("当前温度: "+t._s(t.currentTemperature/100)+"°C")]),e("h3",{staticClass:"host-temperature"},[t._v("主机温度: "+t._s(t.hostTemperatureLow+"~"+t.hostTemperatureHigh)+"°C")]),e("h3",{staticClass:"host-mode"},[t._v("主机工作模式： "+t._s("REFRIGERATION"===t.hostMode?"制冷":"制热")+" ")]),e("h3",{staticClass:"fan-mode"},[t._v("送风状态："+t._s(1==t.fanStatus?"开启":"关闭"))])])},N=[],A={data(){return{intervals:[]}},mounted(){console.log("Component mounted, fetching temperature..."),this.$store.dispatch("getCurrentTemperature"),this.$store.dispatch("getMasterStatus"),this.$store.dispatch("getFanStatus"),this.intervals.push(setInterval((()=>{this.$store.dispatch("getMasterStatus")}),1e3)),this.intervals.push(setInterval((()=>{this.$store.dispatch("getFanStatus")}),1e3)),this.intervals.push(setInterval((()=>{this.$store.dispatch("getCurrentTemperature")}),1e3))},beforeDestroy(){this.intervals.forEach((t=>clearInterval(t)))},computed:{hostTemperatureLow(){return this.$store.state.hostTemperatureLow},hostTemperatureHigh(){return this.$store.state.hostTemperatureHigh},hostMode(){return this.$store.state.hostMode},fanStatus(){return console.log("fanStatus",this.$store.state.fanStatus),this.$store.state.fanStatus},currentTemperature(){return this.$store.state.currentTemperature}}},R=A,w=(0,c.A)(R,C,N,!1,null,"cd77ede0",null),O=w.exports,$=function(){var t=this,e=t._self._c;return e("div",{staticClass:"control-panel"},[e("div",{staticClass:"temperature-setting"},[e("label",{staticClass:"label"},[t._v("目标温度:")]),e("div",{staticClass:"temp-control"},[e("button",{on:{click:function(e){return t.changeTemperature(-1)}}},[t._v("降低一度")]),e("span",{staticClass:"current-temp"},[t._v(t._s(t.targetTemperature/100)+"°C")]),e("button",{on:{click:function(e){return t.changeTemperature(1)}}},[t._v("升高一度")])])]),e("div",{staticClass:"fan-speed-buttons"},[e("span",{staticClass:"label"},[t._v("风速调节")]),e("button",{class:{active:"SLOW"===t.fanSpeed},on:{click:function(e){return t.setFanSpeed("SLOW")}}},[t._v("低速")]),e("button",{class:{active:"MEDDLE"===t.fanSpeed},on:{click:function(e){return t.setFanSpeed("MEDDLE")}}},[t._v("中速")]),e("button",{class:{active:"FAST"===t.fanSpeed},on:{click:function(e){return t.setFanSpeed("FAST")}}},[t._v("高速")])]),e("button",{staticClass:"submit-button",on:{click:t.submitSettings}},[t._v("提交设置")])])},F=[],M={data(){return{mode:"cool",fanSpeed:"FAST",timer:null}},methods:{setFanSpeed(t){this.fanSpeed=t},changeTemperature(t){const e=this.$store.state.hostTemperatureLow,r=this.$store.state.hostTemperatureHigh,o=this.$store.state.targetTemperature/100+t;o<e||o>r?window.alert("当前温度已经达到上下限，无法再次调节。"):1===t?this.$store.dispatch("increaseTemperature",this.targetTemperature+100):-1===t&&this.$store.dispatch("decreaseTemperature",this.targetTemperature-100)},submitSettings(){let t=this.fanSpeed.toString();console.log("this.fanSpeed",t),this.$store.state.fanSpeed=this.fanSpeed,this.$store.dispatch("changeFanSpeed")}},computed:{roomNumber(){return this.$store.state.roomNumber},targetTemperature(){return this.$store.dispatch("getTargetTemperature"),this.$store.state.targetTemperature},targetMode(){return this.$store.state.targetMode}}},I=M,P=(0,c.A)(I,$,F,!1,null,"7d2be18e",null),U=P.exports,H={name:"ControlPanel",components:{TemperatureDisplay:O,TemperatureControl:U},data(){return{}},methods:{toggleAirConditioning(){if(!this.$store.state.Host)return alert("host is not true"),!1;this.$store.dispatch("toggleAirConditioning"),this.intervalId=setInterval((()=>{this.$store.dispatch("getFeeAndEnergy")}),1e3)},logout(){this.$store.dispatch("logout"),clearInterval(this.intervalId),this.$router.push("/")}},computed:{roomNumber(){return this.$store.state.roomNumber},state(){return this.$store.state.airConditioning},Host(){return this.$store.state.Host},energy(){return this.$store.state.energy},fee(){return this.$store.state.cost}}},L=H,D=(0,c.A)(L,E,y,!1,null,"52a934a7",null),G=D.exports;o.Ay.use(d.Ay);var k=new d.Ay({mode:"history",routes:[{path:"/",name:"LoginPage",component:b},{path:"/control-panel",name:"ControlPanel",component:G,props:!0}]});o.Ay.use(a.Ay);const x="http://localhost:8081";var j=new a.Ay.Store({state:{currentTemperature:"",targetTemperature:"",mode:"cool",cost:0,roomNumber:"",airConditioning:!1,fanSpeed:"FAST",hostTemperatureLow:18,hostTemperatureHigh:25,hostMode:"",Host:!0,energy:0,fanStatus:"yes"},mutations:{TOGGLE_AIR_CONDITIONING(t){t.airConditioning=!t.airConditioning},SET_ROOM_NUMBER(t,e){console.log("hello"),t.roomNumber=e},updateTemperature(t,e){t.targetTemperature=e.targetTemp},UPDATE_COST(t,e){t.cost=e},UPDATE_ENERGY(t,e){t.energy=e},SET_CURRENT_TEMPERATURE(t,e){t.currentTemperature=e},SET_FAN_SPEED(t,e){t.fanSpeed=e},SET_TARGET_TEMPERATURE(t,e){t.targetTemperature=e},SET_HOST_MODE(t,e){console.log("SET_CURRENT_HOST_MODE",e),t.hostMode=e},SET_HOST_TEMPERATURE_LOW(t,e){t.hostTemperatureLow=e},SET_HOST_TEMPERATURE_HIGH(t,e){t.hostTemperatureHigh=e},SET_FAN_STATUS(t,e){t.fanStatus=e}},actions:{setRoomNumber({commit:t},e){t("SET_ROOM_NUMBER",e)},setTemperature({commit:t},e){t("updateTemperature",e)},updateCost({commit:t},e){t("updateCost",e)},setCurrentTemperature({commit:t},e){t("SET_CURRENT_TEMPERATURE",e)},setFanSpeed({commit:t},e){t("SET_FAN_SPEED",e)},async toggleAirConditioning({state:t}){t.airConditioning?await this.dispatch("stopSlave"):await this.dispatch("startSlave")},async startSlave({state:t,commit:e}){try{const r=await g.A.post(`${x}/PowerOn`,{params:{roomNumber:t.roomNumber}});console.log("Slave started",r.data),e("TOGGLE_AIR_CONDITIONING")}catch(r){console.error("Failed to start slave",r)}},async stopSlave({state:t,commit:e}){try{const r=await g.A.post(`${x}/PowerOff`,{params:{roomNumber:t.roomNumber}});console.log("Slave stopped",r.data),e("TOGGLE_AIR_CONDITIONING")}catch(r){console.error("Failed to stop slave",r)}},async getTargetTemperature({state:t,commit:e}){try{const r=await g.A.post(`${x}/setTemp`,{params:{roomNumber:t.roomNumber}});console.log("Target temperature retrieved",r.data.data),e("SET_TARGET_TEMPERATURE",r.data.data)}catch(r){console.error("Failed to get target temperature",r)}},async increaseTemperature({state:t,commit:e}){try{const r=await g.A.post(`${x}/upSetTemp`,{params:{roomNumber:t.roomNumber}});console.log("Temperature increased",r.data),e("SET_TARGET_TEMPERATURE",r.data.data)}catch(r){console.error("Failed to increase temperature",r)}},async decreaseTemperature({state:t,commit:e}){try{const r=await g.A.post(`${x}/downSetTemp`,{params:{roomNumber:t.roomNumber}});console.log("Temperature decreased",r.data),e("SET_TARGET_TEMPERATURE",r.data.data)}catch(r){console.error("Failed to decrease temperature",r)}},async changeFanSpeed({state:t}){console.log("changeFanSpeed",t.fanSpeed);try{const e=await g.A.post(`${x}/changeSpeed`,null,{params:{newSpeed:t.fanSpeed}});console.log("Fan speed changed",e.data)}catch(e){console.error("Failed to change fan speed",e)}},async getFee({state:t,commit:e}){try{const r=await g.A.post(`${x}/getFee`,null,{params:{roomNumber:t.roomNumber}});console.log("Fee retrieved",r.data),e("UPDATE_COST",r.data.data)}catch(r){console.error("Failed to get fee",r),window.alert("主机连接失败，请检查网络连接")}},async getCurrentTemperature({state:t,commit:e}){try{const r=await g.A.post(`${x}/curTemp`,{params:{roomNumber:t.roomNumber}});e("SET_CURRENT_TEMPERATURE",r.data.data)}catch(r){console.error("Failed to get current temperature",r)}},async getMasterStatus({commit:t}){try{const e=await g.A.get(`${x}/getMasterStatus`);console.log("Master status retrieved",e.data.data.workmode),t("SET_HOST_TEMPERATURE_LOW",e.data.data.range[0]/100),t("SET_HOST_TEMPERATURE_HIGH",e.data.data.range[1]/100),t("SET_HOST_MODE",e.data.data.workmode)}catch(e){console.warn("Failed to get master status",e),console.error("Failed to get master status",e)}},async getFanStatus({commit:t}){try{const e=await g.A.get(`${x}/wind`);console.log("Fan mode retrieved",e.data.data),t("SET_FAN_STATUS",e.data.data)}catch(e){console.error("Failed to get fan mode",e)}},async getFeeAndEnergy({state:t,commit:e}){try{const r=await g.A.post(`${x}/getFee`,null,{params:{roomId:t.roomNumber}});console.log("Fee and energy retrieved",r),e("UPDATE_COST",r.data.data[1]),e("UPDATE_ENERGY",r.data.data[0])}catch(r){console.error("Failed to get fee and energy",r),window.alert("主机连接失败，请检查网络连接")}},async logout({state:t,commit:e}){try{const r=await g.A.post(`${x}/logout`,null,{params:{roomId:t.roomNumber}});console.log("Logout",r.data),e("SET_ROOM_NUMBER","")}catch(r){console.error("Failed to logout",r)}}},getters:{roomNumber:t=>t.roomNumber,airConditioning:t=>t.airConditioning,currentTemperature:t=>t.currentTemperature,targetTemperature:t=>t.targetTemperature,targetMode:t=>t.targetMode,currentCost:t=>t.currentCost,fanSpeed:t=>t.fanSpeed,hostTemperatureLow:t=>t.hostTemperatureLow,hostTemperatureHigh:t=>t.hostTemperatureHigh,hostMode:t=>t.hostMode,mode:t=>t.mode,Host:t=>t.Host,fanStatus:t=>t.fanStatus,cost:t=>t.currentCost}});o.Ay.use(a.Ay),o.Ay.config.productionTip=!1,new o.Ay({router:k,store:j,render:t=>t(m)}).$mount("#app")}},e={};function r(o){var a=e[o];if(void 0!==a)return a.exports;var s=e[o]={exports:{}};return t[o].call(s.exports,s,s.exports,r),s.exports}r.m=t,function(){var t=[];r.O=function(e,o,a,s){if(!o){var n=1/0;for(l=0;l<t.length;l++){o=t[l][0],a=t[l][1],s=t[l][2];for(var i=!0,u=0;u<o.length;u++)(!1&s||n>=s)&&Object.keys(r.O).every((function(t){return r.O[t](o[u])}))?o.splice(u--,1):(i=!1,s<n&&(n=s));if(i){t.splice(l--,1);var c=a();void 0!==c&&(e=c)}}return e}s=s||0;for(var l=t.length;l>0&&t[l-1][2]>s;l--)t[l]=t[l-1];t[l]=[o,a,s]}}(),function(){r.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(e,{a:e}),e}}(),function(){r.d=function(t,e){for(var o in e)r.o(e,o)&&!r.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:e[o]})}}(),function(){r.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}}(),function(){var t={524:0};r.O.j=function(e){return 0===t[e]};var e=function(e,o){var a,s,n=o[0],i=o[1],u=o[2],c=0;if(n.some((function(e){return 0!==t[e]}))){for(a in i)r.o(i,a)&&(r.m[a]=i[a]);if(u)var l=u(r)}for(e&&e(o);c<n.length;c++)s=n[c],r.o(t,s)&&t[s]&&t[s][0](),t[s]=0;return r.O(l)},o=self["webpackChunkfront_user"]=self["webpackChunkfront_user"]||[];o.forEach(e.bind(null,0)),o.push=e.bind(null,o.push.bind(o))}();var o=r.O(void 0,[504],(function(){return r(9664)}));o=r.O(o)})();
//# sourceMappingURL=app.40bbccbe.js.map